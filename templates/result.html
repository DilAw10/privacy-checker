<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Privacy & Security Scanner ‚Äî Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>üîí Privacy & Security Scanner</h1>
            <p class="muted">Results for <code style="background:transparent; color:inherit;">{{ url }}</code></p>
        </div>
    </div>

    <div class="container">
        {% if error %}
            <div class="alert alert-error">
                <strong>‚ö†Ô∏è Error:</strong> {{ error }}
            </div>
            <p><a class="btn-scan" href="/">Check another site</a></p>
        {% else %}
            <div class="results-container">
                <div class="result-header" style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
                    <div>
                        <h2>{{ url }}</h2>
                        <p class="scan-time">Scanned on {{ (loop_time if loop_time is defined else '') }}</p>
                    </div>
                </div>

                <div class="grid">
                    <!-- Left column -->
                    <div class="col">
                        <!-- Security Score Card -->
                        <div class="result-card">
                            <div class="card-header"><h3>üìà Security Score</h3></div>
                            {% set cls = 'good' if security_score >= 80 else ('warn' if security_score >= 50 else 'bad') %}
                            <div style="display:flex; align-items:center; gap:24px;">
                                <div class="score {{ cls }}">{{ security_score }} / 100</div>
                                <div>
                                    <p class="text-muted">A concise heuristic based on headers, trackers, and HTTPS.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Findings Card -->
                        <div class="result-card">
                            <div class="card-header"><h3>üõ°Ô∏è Findings</h3></div>
                            {% if findings %}
                                <ul>
                                    {% for f in findings %}
                                        <li>{{ f }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <p class="text-success">‚úÖ No issues detected.</p>
                            {% endif %}
                        </div>

                        <!-- Summary Card -->
                        <div class="result-card">
                            <div class="card-header"><h3>üìä Summary</h3></div>
                            <p>Review the findings and prioritize fixes to improve your score.</p>
                        </div>
                    </div>

                    <!-- Right column -->
                    <div class="col">
                        <!-- Connection & Playwright -->
                        <div class="result-card">
                            <div class="card-header"><h3>üåê Connection & Rendering</h3></div>
                            <p class="text-muted">Playwright available: <strong>{{ playwright.available if playwright is defined else 'Unknown' }}</strong></p>
                            {% if playwright and playwright.info %}
                                <div class="status-badge warning">{{ playwright.info }}</div>
                            {% endif %}
                        </div>

                        <!-- Trackers Card (derived from findings) -->
                        <div class="result-card">
                            <div class="card-header"><h3>üìä Trackers</h3></div>
                            {% set tracker_list = [] %}
                            {% for f in findings %}
                                {% set lowered = f | lower %}
                                {% if 'google' in lowered or 'analytics' in lowered or 'gtag' in lowered or 'ga(' in lowered %}
                                    {% if 'Google Analytics' not in tracker_list %}{% set tracker_list = tracker_list + ['Google Analytics'] %}{% endif %}
                                {% elif 'facebook' in lowered or 'fbq' in lowered %}
                                    {% if 'Facebook Pixel' not in tracker_list %}{% set tracker_list = tracker_list + ['Facebook Pixel'] %}{% endif %}
                                {% elif 'adsbygoogle' in lowered or 'adsense' in lowered %}
                                    {% if 'Google AdSense' not in tracker_list %}{% set tracker_list = tracker_list + ['Google AdSense'] %}{% endif %}
                                {% elif 'doubleclick' in lowered %}
                                    {% if 'DoubleClick' not in tracker_list %}{% set tracker_list = tracker_list + ['DoubleClick'] %}{% endif %}
                                {% endif %}
                            {% endfor %}

                            {% if tracker_list %}
                                <div class="trackers-list">
                                    {% for t in tracker_list %}
                                        <div class="tracker-badge">{{ t }}</div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <p class="text-success">‚úÖ No known trackers detected</p>
                            {% endif %}
                        </div>

                        <!-- Privacy placeholder -->
                        <div class="result-card">
                            <div class="card-header"><h3>üìã Privacy & Legal</h3></div>
                            <p class="text-muted">Privacy policy checks are not available in this quick view. Use deeper scan tools for policy detection.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align:center; margin-top:24px;">
                <a class="btn-scan" href="/">Scan another site</a>
            </div>

        {% endif %}
    </div>

    <footer>
        <p>Privacy & Security Scanner 2026 | Always verify results independently</p>
    </footer>


</body>
</html>